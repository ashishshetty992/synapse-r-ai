=== Testing /synapse/paths endpoint with debug features ===

=== A) Product category (2 paths) ===
[
  {
    "edge": "orders.id → order_item.order_id",
    "why": "fk_rev",
    "hop": 1,
    "baseCos": 0.225282,
    "basePrior": 0.18,
    "blend": 0.213961,
    "notes": {
      "idPriorIf_*_id": 0.12,
      "fkBonusIfFkOrRev": 0.06,
      "dirBonus(pkToFk,fkToPk)": [
        0.0,
        0.0
      ],
      "hubPen": 0.0,
      "hubThresh": 8,
      "fanoutPenPerExtra": 0.0
    }
  },
  {
    "edge": "order_item.product_id → product.id",
    "why": "fk",
    "hop": 2,
    "baseCos": 0.168877,
    "basePrior": 0.18,
    "blend": 0.171658,
    "notes": {
      "idPriorIf_*_id": 0.12,
      "fkBonusIfFkOrRev": 0.06,
      "dirBonus(pkToFk,fkToPk)": [
        0.0,
        0.0
      ],
      "hubPen": 0.0,
      "hubThresh": 8,
      "fanoutPenPerExtra": 0.0
    }
  }
]
{
  "avgCos": 0.19708,
  "avgPrior": 0.18,
  "rawBlend": 0.19281,
  "lengthPrior": 0.9,
  "final": 0.173529
}

Parity check:
{
  "ok": true,
  "rows": [
    {
      "i": 0,
      "score": 0.17352870176264892,
      "final": 0.173529,
      "diff": -2.982373510651559e-07
    }
  ]
}

=== B) Product category (3 paths) - scoreMax + normalized scores ===
0.17352870176264892
[
  1.0
]

=== C) Zero-hop case (goal = start entity) ===
{
  "path": [],
  "score": 1.0,
  "hops": 0
}
[]
{
  "avgCos": 0.0,
  "avgPrior": 0.0,
  "rawBlend": 0.0,
  "lengthPrior": 1.0,
  "final": 1.0
}

=== D) One-hop to customer.city ===
{
  "path": [
    {
      "srcEntity": "orders",
      "srcField": "customer_id",
      "dstEntity": "customer",
      "dstField": "id",
      "why": "fk"
    }
  ],
  "score": 0.2083171437704066,
  "hops": 1
}
[
  {
    "edge": "orders.customer_id → customer.id",
    "why": "fk",
    "hop": 1,
    "baseCos": 0.217756,
    "basePrior": 0.18,
    "blend": 0.208317,
    "notes": {
      "idPriorIf_*_id": 0.12,
      "fkBonusIfFkOrRev": 0.06,
      "dirBonus(pkToFk,fkToPk)": [
        0.0,
        0.0
      ],
      "hubPen": 0.0,
      "hubThresh": 8,
      "fanoutPenPerExtra": 0.0
    }
  }
]
{
  "avgCos": 0.217756,
  "avgPrior": 0.18,
  "rawBlend": 0.208317,
  "lengthPrior": 1.0,
  "final": 0.208317
}

Parity check:
{
  "ok": true,
  "rows": [
    {
      "i": 0,
      "score": 0.2083171437704066,
      "final": 0.208317,
      "diff": 1.4377040660762397e-07
    }
  ]
}

=== E) Test knob overrides ===
Setting lighter priors...
{
  "idPrior": 0.08,
  "fkBonus": 0.03,
  "lengthPriorBase": 0.92,
  "cosineWeight": 0.75,
  "pkToFkBonus": 0.0,
  "fkToPkBonus": 0.0,
  "bridgePenalty": 0.0,
  "hubPenalty": 0.0,
  "hubDegreeThreshold": 8,
  "fanoutPenalty": 0.0
}

Re-running category paths with new knobs...
{
  "idPrior": 0.12,
  "fkBonus": 0.06,
  "lengthPriorBase": 0.9,
  "cosineWeight": 0.75,
  "pkToFkBonus": 0.0,
  "fkToPkBonus": 0.0,
  "bridgePenalty": 0.0,
  "hubPenalty": 0.0,
  "hubDegreeThreshold": 8,
  "fanoutPenalty": 0.0,
  "_source": "active"
}
[
  {
    "edge": "orders.id → order_item.order_id",
    "why": "fk_rev",
    "hop": 1,
    "baseCos": 0.225282,
    "basePrior": 0.18,
    "blend": 0.213961,
    "notes": {
      "idPriorIf_*_id": 0.12,
      "fkBonusIfFkOrRev": 0.06,
      "dirBonus(pkToFk,fkToPk)": [
        0.0,
        0.0
      ],
      "hubPen": 0.0,
      "hubThresh": 8,
      "fanoutPenPerExtra": 0.0
    }
  },
  {
    "edge": "order_item.product_id → product.id",
    "why": "fk",
    "hop": 2,
    "baseCos": 0.168877,
    "basePrior": 0.18,
    "blend": 0.171658,
    "notes": {
      "idPriorIf_*_id": 0.12,
      "fkBonusIfFkOrRev": 0.06,
      "dirBonus(pkToFk,fkToPk)": [
        0.0,
        0.0
      ],
      "hubPen": 0.0,
      "hubThresh": 8,
      "fanoutPenPerExtra": 0.0
    }
  }
]
{
  "avgCos": 0.19708,
  "avgPrior": 0.18,
  "rawBlend": 0.19281,
  "lengthPrior": 0.9,
  "final": 0.173529
}

=== Tests complete ===
